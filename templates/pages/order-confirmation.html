{{#partial "head"}}

{{{ checkout.checkout_head }}}
{{{ stylesheet '/assets/css/optimized-checkout.css' }}}
{{{ stylesheet '/assets/css/orderconfirmation.css' }}}
{{ getFontsCollection }}

<script>
    {{ assignVar "startyourlearning" "https://www.umbctraining.com/courses/IT-Fundamentals/" }}
    {{ assignVar "gotodashboard"   "https://www.pearson.com/pathways/recommended-programs.html" }}
    {{ assignVar "findmoreprograms" "https://www.pearson.com/pathways/program-profiles.html" }}
    {{ assignVar "supportEmail"   "enrollments@regis.com" }}
    {{ assignVar "Gotohomepage" "https://www.pearson.com/" }}
    {{ assignVar "Collegenamefooter" "Regis College"}}
    // enrollment dashboard section
    {{ assignVar "EnrollDashTitle" "Enrollments dashboard"}}
    {{ assignVar "DashbordDescription" 'Manage all courses you are enrolled on in one place'}}
    {{ assignVar "Gotodashboardtitle" 'Go to dashboard'}}
    // online program section
    {{ assignVar "EnrollProgramTitle" 'Online programs'}}
    {{ assignVar "ProgramsDescription" 'Search for more programs among 5000+ courses in 25 areas of study'}}
    {{ assignVar "findmoreprogramstitle" 'Find more programs'}}

    {{ assignVar "dashboardicon" 'https://cdn11.bigcommerce.com/s-b5ajmj9rbq/images/stencil/original/image-manager/dashboard-icon.png'}}
    {{ assignVar "onlineprogramicon" 'https://cdn11.bigcommerce.com/s-b5ajmj9rbq/images/stencil/original/image-manager/online-programs.png'}}


    
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

<script type="text/javascript">
    window.language = {{langJson 'optimized_checkout' }};
</script>



{{{head.scripts}}}

{{/partial}}

{{#partial "page"}}

<style>
    /* icon for manage your enrollment */
    .enrollicon{
        width: 27.1px;
        height: 22.31px;
    }
</style>

<header class="containercheckout-header">
    <div class="containercheckout-head-main">
        <div>
            <a href="{{getVar 'Gotohomepage' }}">
                <img alt="{{settings.store_logo.title}}" class="checkoutHeader-logo" id="logoImage"
                    src="{{ checkout.header_image }}" />
            </a>
        </div>
        <div>
            <a href="{{getVar 'Gotohomepage'}}">
                <h4 class="cancel-header">Cancel</h4>
            </a>
        </div>
    </div>
</header>


<div id="main-contianer-div">
    <div id="order_confirmation_content">
        {{{ checkout.order_confirmation_content }}}
    </div>
    <div id="enrollmentsection">
        <div class="maincontainer1">
            <p id="supporttext"></p>
            <p id="gotohomepage"></p>
            <hr class="spaceingline">
            <h2 class="article-block-title">Manage your enrollments</h2>
            <hr class="underenrollment">
            <div class="enrollment-box-main">
                <div class="subcontainer1">
                    <h3 class="productmainhead" id="masterproductname"></h3>
                    <div class="labeldate">
                        <div>
                            <p class="label" id="label1"></p>
                            <p class="date" id="value1"></p>
                        </div>
                        <div>
                            <p class="label" id="label2"></p>
                            <p class="date" id="value2"></p>
                        </div>
                    </div>
                    <div class="labeldate">
                        <div>
                            <p class="label" id="label3"></p>
                            <p class="date" id="value3"></p>
                        </div>
                        <div>
                            <p class="label" id="label4"></p>
                            <p class="date" id="value4"></p>
                        </div>
                    </div>
                    <a href="{{getVar 'startyourlearning' }}">
                        <button class="learnbutton">Start your learning</button>
                    </a>
                </div>
                <div class="subcontainer2">
                    <div class="DashboardSection">
                        <div class="TitleDescription">
                            <div>
                               <img src="{{getVar 'dashboardicon'}}" alt="dashboardicon" class="enrollicon">
                            </div>
                            <h2 class="EnrollDashTitle">{{getVar 'EnrollDashTitle'}}</h2>
                        </div>
                        <p class="DashbordDescription">{{getVar 'DashbordDescription'}}</p>
                        <div class="IconTitle">
                            <a href="{{getVar 'gotodashboard' }}" class="button-label underlinelink">{{getVar 'Gotodashboardtitle'}}</a>
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M11.5614 7.37806C11.8916 7.74591 11.8788 8.30973 11.5229 8.66235L6.41346 13.7256C6.04431 14.0915 5.44581 14.0915 5.07666 13.7256C4.70752 13.3598 4.70752 12.7667 5.07666 12.4009L9.51776 8L5.07666 3.59906C4.70752 3.23325 4.70752 2.64016 5.07667 2.27436C5.44581 1.90855 6.04431 1.90855 6.41346 2.27436L11.5229 7.33765C11.5365 7.35104 11.5493 7.36449 11.5614 7.37806Z"
                                    fill="#A52238" />
                            </svg>
                        </div>
                    </div>
                    <div>
                        <div class="ProgramsSection">
                            <div>
                              <img src="{{getVar 'onlineprogramicon'}}" alt="onlineprogramicon" class="enrollicon">
                            </div>
                            <h2 class="EnrollProgramTitle">{{getVar 'EnrollProgramTitle'}}</h2>
                        </div>
                        <p class="ProgramsDescription">{{getVar 'ProgramsDescription'}}</p>
                        <div class="IconTitle">
                            <a class="button-label underlinelink" href=" {{getVar 'findmoreprograms'}} ">{{getVar 'findmoreprogramstitle'}}</a>
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M11.5614 7.37806C11.8916 7.74591 11.8788 8.30973 11.5229 8.66235L6.41346 13.7256C6.04431 14.0915 5.44581 14.0915 5.07666 13.7256C4.70752 13.3598 4.70752 12.7667 5.07666 12.4009L9.51776 8L5.07666 3.59906C4.70752 3.23325 4.70752 2.64016 5.07667 2.27436C5.44581 1.90855 6.04431 1.90855 6.41346 2.27436L11.5229 7.33765C11.5365 7.35104 11.5493 7.36449 11.5614 7.37806Z"
                                    fill="#A52238" />
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<footer class="containercheckout-footer">
    <div class="containercheckout-footer-main">
        <div>
            <img alt="{{settings.store_logo.title}}" style="opacity: .2;width: 200px;" class='checkoutHeader-logo'
                id="footerlogo" src="{{ checkout.header_image }}" />
        </div>
        <div>
            <p class="footer-copy">Â© {{moment "now" "YYYY"}} {{getVar 'Collegenamefooter' }} . All rights reserved.</p>
        </div>
    </div>
</footer>


{{json order}}





<style>
    .optimizedCheckout-headingPrimary{
        display: none;
    }
    .layout-cart{
        display: none;
    }
    .containercheckout-header{
        display: none;
    }
    #enrollmentsection{
        display: none;
    }
    .containercheckout-footer{
        display: none;
    }
</style>


<script>
    var ele = setInterval(ordercustomisation, 3000)


    function ordercustomisation() {
        console.log('order customisation function runing........');
        $('[data-test="order-confirmation-heading"]').text('Thank you for your order!');
        $('.optimizedCheckout-headingPrimary').show()

        var content = `An email will be sent containing information about your purchase. If you have any questions about your purchase, email us at <span style='color:#A52238;'>{{getVar "supportEmail"}}.</span>`
        var ordersummeryhead = 'Order information'

        var orderIdAppend = "<div class='ordernumberlabel'><p class='ordernumber'>Order Number<p><p class='ordernumber'>{{checkout.order.id}}</p></div>"

        // Appending total label to remove 'inr'
        $('.cart-priceItem--total .cart-priceItem-label').html(`<span data-test="cart-price-label">Total</span>`)

        $('#supporttext').append(content).show()


        $('.optimizedCheckout-headingSecondary').text(ordersummeryhead);

        $('[data-test="cart-item-digital-product"]').hide()



        $('#gotohomepage').html(`<a href="{{getVar "Gotohomepage"}}" class='gotohomepage underlinelink'>Go to homepage</a>   <svg width="16" class='right-direction' height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M11.5614 7.37806C11.8916 7.74591 11.8788 8.30973 11.5229 8.66235L6.41346 13.7256C6.04431 14.0915 5.44581 14.0915 5.07666 13.7256C4.70752 13.3598 4.70752 12.7667 5.07666 12.4009L9.51776 8L5.07666 3.59906C4.70752 3.23325 4.70752 2.64016 5.07667 2.27436C5.44581 1.90855 6.04431 1.90855 6.41346 2.27436L11.5229 7.33765C11.5365 7.35104 11.5493 7.36449 11.5614 7.37806Z"
                            fill="#A52238" />

        </svg>`);



        $('.productList').before(orderIdAppend)


        /* When the orderconfirmation content loaded then only show the Enroll_section and Student_section */
        // if ($(".orderConfirmation")[0]) {
        // if ($(".optimizedCheckout-orderSummary")[0]) {
        //     console.log($(".optimizedCheckout-orderSummary")[0])
        //     console.log('class exists.......');
        //     // $('.optimizedCheckout-contentPrimary').show()
        //     $('.containercheckout-header').show()
        //     $('#enrollmentsection').show()
        //     $('.containercheckout-footer').show()
        // } else {
        //     // $('.optimizedCheckout-contentPrimary').show()
        //     $('.containercheckout-header').show()
        //     $('#enrollmentsection').show()
        //     $('.containercheckout-footer').show()
        // }

        $('.containercheckout-header').show()
       
        $('.layout-cart').show()

        $('#enrollmentsection').show()

        $('.containercheckout-footer').show()

        clearInterval(ele);
    }

    getOrderDetails()

    // ajax calling to get order details useing order id through storefront api
    async function getOrderDetails() {
        var orderId = '{{checkout.order.id}}';
        const settings = {
            "async": true,
            "crossDomain": true,
            "url": `/api/storefront/orders/${orderId}`,
            "method": "GET",
            "headers": {
                "Content-Type": "application/json"
            }
        };

        $.ajax(settings).done(function (res) {
            console.log('storefront details', res)
            var productSku = res.lineItems.digitalItems[0].sku;
            getProductDetails(productSku)
        });
    }


    // getting categories product useing product sku through graphql
    async function getProductDetails(productSku) {
        var data = await fetch('/graphql', {
            method: 'POST',
            mode: 'cors',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer {{ settings.storefront_api.token }}`
            },
            body: JSON.stringify({
                query: `
                query VariantB {
   site {
     product(sku: "${productSku}") {
       name
       sku
       customFields{
        edges{
          node{
            name
            value
          }
        }
      }
       defaultImage {
         url(width: 500, height: 500)
       }
       prices {
         price {
           ...PriceFields
         }
       }
     }
   }
 }
 fragment PriceFields on Money {
   value
   currencyCode
 }
                
                `
            }),
        })
            .then(res => res.json())
            .then(data1 => {
                customFields = data1.data.site.product.customFields.edges;
                productMasterName = data1.data.site.product.name;
                
                $('#masterproductname').append(productMasterName)

                customFields.forEach(res => {
                    var customlabel = res.node.name;
                    var customvalue = res.node.value;


                    if (customlabel == 'Time Commitment') {
                        $('#label1').append(customlabel);
                        $('#value1').append(customvalue);
                    }
                    else if (customlabel == 'Duration') {
                        $('#label2').append(customlabel);
                        $('#value2').append(customvalue)
                    }
                    else if (customlabel == 'Learning Format') {
                        $('#label3').append(customlabel);
                        $('#value3').append(customvalue)
                    }
                    else if (customlabel == 'Prerequisites') {
                        $('#label4').append(customlabel);
                        $('#value4').append(customvalue)
                    }
                });
            })
    }

</script>






<!-- mobile section cart card section append here  -->
<!-- <div class="mobile-product-cart container"></div> -->



<script>
    // ********************************************************************************
    // ************************* mobile section product cart fetch data start ********************************
    // ********************************************************************************
    var width = $(window).width();
    if (width <= 950) {
        $(document).on("click", "#cart-print-link", function (e) {
            e.preventDefault()
            window.print()
        });

        var getmobileproduct = setInterval(function () {
            if ($('.optimizedCheckout-orderSummary')[0]) {
                $('.optimizedCheckout-orderSummary').click()
                $('body').removeClass('has-activeModal')
                $('[data-test="order-confirmation-heading"]').text('Thank you for your order!');

                $('[data-test="modal-heading"]').text("Order information")
                var orderIdAppend = "<div class='ordernumberlabel'><p class='ordernumber'>Order Number<p><p class='ordernumber'>{{checkout.order.id}}</p></div>"
                $('.productList').before(orderIdAppend)

                $('.optimizedCheckout-headingPrimary').show()

                var mobilecart = $('.ReactModalPortal .cart-modal-body').clone()
                var bodycart = $('.ReactModalPortal .cart-modal-header.optimizedCheckout-orderSummary').clone()
                $(mobilecart).removeClass('modal-body cart-modal')
                // console.log("mobilecart", mobilecart)
                // console.log("mobilecart body", mobilecart.find('.cart-modal-body'))
                $('.optimizedCheckout-headingPrimary').after(mobilecart)
                $('.cart-modal-body.optimizedCheckout-orderSummary').prepend(bodycart)
                $('#cart-print-link').removeAttr("href");

                clearInterval(getmobileproduct);
            }
        }, 1000);
    }
    // ********************************************************************************
    // ************************* mobile section product card fetch data end ********************************
    // ********************************************************************************
</script>















{{{ footer.scripts }}}

{{/partial}}

{{> layout/empty}}